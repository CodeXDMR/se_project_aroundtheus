!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleInputError(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(t=>{this._toggleInputError(e),this._toggleButtonState()}))})),this._toggleButtonState()}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetForm(){this._disableButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}var t=class{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._closeButton=this._popupElement.querySelector(".modal__close-button")}open(){this._popupElement.classList.add("modal__open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal__open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>{this.close()}))}},r=class extends t{constructor(e,t,r,s){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button-submit"),this._handleFormSubmit=t,this._submitButtonText=r,this._loadingButtonText=s}showLoading(){this._submitButton.textContent=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._submitButtonText}_getInputValues(){const e=Array.from(this._popupElement.querySelectorAll(".modal__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._popupForm.reset()}};const s="#card-template",i="#cards-list",n="#profile-avatar-modal",o="#profile-edit-modal",a="#add-card-modal",l="#delete-card-modal",d="#preview-image-modal",h="#profile-avatar",c="#profile-name",u="#profile-about",_={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button-submit",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input_error"},m=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInfoAPI(){return Promise.all([this.getInitialCardsAPI(),this.getProfileInfoAPI()])}getInitialCardsAPI(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getProfileInfoAPI(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}setProfileInfoAPI(e,t){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}setAvatarAPI(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}addCardAPI(e){let{name:t,link:r}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})})}deleteCardAPI(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}addLikeAPI(e){return this._request(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers})}removeLikeAPI(e){return this._request(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"0d34a92c-1da7-4adc-abc0-e2b3b38a4b1f","Content-Type":"application/json"}}),p=document.querySelector("#profile-avatar-container"),f=document.querySelector("#profile-edit-button"),v=document.querySelector("#profile-add-card-button"),g=document.querySelector("#profile-title-input"),E=document.querySelector("#profile-about-input"),b=document.forms["edit-card-form"],L=document.forms["add-card-form"],I=document.forms["avatar-edit-form"],k=new e(_,L),S=new e(_,b),C=new e(_,I);let y,A;const B=new r(n,(function(e){B.showLoading(),m.setAvatarAPI(e.avatURL).then((t=>{w.setAvatar(e.avatURL)})).then((()=>{B.close()})).catch((e=>{alert("Unexpected error, please try again."),console.error("There was an error -",e)})).finally((()=>{B.hideLoading()}))}),"Save","Saving...");B.setEventListeners(),p.addEventListener("click",(()=>{B.open(),C.resetForm()}));const w=new class{constructor(e){let{profNameSelector:t,profAboutSelector:r,profAvatarSelector:s}=e;this._profAvatar=document.querySelector(s),this._profName=document.querySelector(t),this._profAbout=document.querySelector(r)}getProfileInfo(){return{name:this._profName.textContent,about:this._profAbout.textContent}}setProfileInfo(e){let{name:t,about:r}=e;this._profName.textContent=t,this._profAbout.textContent=r}getAvatar(){return this._profAvatar.src}setAvatar(e){this._profAvatar.src=e}openModal(){}}({profAvatarSelector:h,profNameSelector:c,profAboutSelector:u}),q=new r(o,(function(e){let{name:t,about:r}=e;q.showLoading(),m.setProfileInfoAPI(t,r).then((e=>{w.setProfileInfo({name:t,about:r})})).then((()=>{q.close()})).catch((e=>{alert("Unexpected error, please try again."),console.error("There was an error -",e)})).finally((()=>{q.hideLoading()}))}),"Save","Saving...");function P(e,t){const r=s;return A=new class{constructor(e,t,r,s,i,n,o,a,l,d,h){let{name:c,link:u,likes:_,owner:m,_id:p}=e;this._cardId=p,this._cardDeleteButton=a,this._cardElement=o,this._cardImage=l,this._cardOwnerID=m._id,this._cardSelector=t,this._cardTitle=d,this._handleImageClick=r,this._imageLink=u,this._imageName=c,this._handleDeleteCardPopup=s,this._handleLikeClick=i,this._likeCounter=h,this._likes=_,this._userID=n}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeClick(this))),this._cardDeleteButton.addEventListener("click",(()=>this._handleDeleteCardPopup(this))),this._cardImage.addEventListener("click",(()=>this._handleImageClick({link:this._imageLink,name:this._imageName}))),this._fillCardTemplate()}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector("#cards-template-list").cloneNode(!0)}_fillCardTemplate(){this._cardImage.alt=this._profName,this._cardImage.src=this._imageLink,this._cardElement.id=this._userID,this._cardTitle.textContent=this._imageName,this._renderLikes(),this._userID!==this._cardOwnerID&&this._cardDeleteButton.remove()}deleteCard(){this._cardElement.remove(),this._cardElement=null}isLiked(){return this._likes.some((e=>e._id===this._userID))}setLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){this._likeCounter.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}getView(){return this._cardElement=this._getTemplate(),this._likeCounter=this._cardElement.querySelector("#card-like-counter"),this._likeButton=this._cardElement.querySelector("#card-like-button"),this._cardDeleteButton=this._cardElement.querySelector("#card-delete-button"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._setEventListeners(),this._cardElement}}(e,r,x,$,N,t),A.getView()}q.setEventListeners(),f.addEventListener("click",(()=>{q.open();const e=w.getProfileInfo();g.value=e.name,E.value=e.about})),m.getInfoAPI().then((e=>{let[t,r]=e;y=new class{constructor(e,t){let{items:r,renderer:s}=e;this._renderedItems=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._renderedItems.reverse().forEach(this._renderer)}addItem(e){this._container.prepend(e)}}({items:t,renderer:e=>{const t=P(e,r._id);y.addItem(t)}},i),y.renderItems(),w.setProfileInfo(r),w.setAvatar(r.avatar)})).catch((e=>{alert("Unexpected error, please try again."),console.error("There was an error -",e)}));const T=new class extends t{constructor(e){super({popupSelector:e}),this._imageElement=this._popupElement.querySelector("#modal-preview-image"),this._imageCaption=this._popupElement.querySelector("#modal-preview-title"),super.setEventListeners()}open(e){this._imageElement.src=e.link,this._imageElement.alt=`Image ${e.name}`,this._imageCaption.textContent=e.name,super.open()}}(d);function x(e){T.open(e)}const U=new r(a,(function(e){let{name:t,link:r}=e;U.showLoading(),m.addCardAPI({name:t,link:r}).then((e=>{const t=P(e,e.owner._id,e._id);y.addItem(t)})).then((()=>{U.close()})).catch((e=>{alert("Unexpected error, please try again."),console.error("There was an error -",e)})).finally((()=>{U.hideLoading()}))}),"Create","Creating...");U.setEventListeners(),v.addEventListener("click",(()=>{U.open(),k.resetForm()}));const D=new class extends r{constructor(e,t,r,s){super(e,t,r,s),this._loadingButtonText=s}setSubmitAction(e){this._handleFormSubmit=e}}(l,$,"Yes","Deleting...");function $(e){D.open(),D.setSubmitAction((()=>{D.showLoading(),m.deleteCardAPI(e._cardId).then((t=>{e.deleteCard()})).then((()=>{D.close()})).catch((e=>{alert("Unexpected error, please try again."),console.error("There was an error -",e)})).finally((()=>{D.hideLoading()}))}))}function N(e){e.isLiked()?m.removeLikeAPI(e._cardId).then((t=>{e.setLikes(t.likes)})).catch((e=>{alert("Unexpected error, please try again."),console.error("There was an error -",e)})):m.addLikeAPI(e._cardId).then((t=>{e.setLikes(t.likes)})).catch((e=>{alert("Unexpected error, please try again."),console.error("There was an error -",e)}))}D.setEventListeners(),k.enableValidation(),S.enableValidation(),C.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0JBQW9CTCxDQUMzQixHTjBOQWtCLEVBQ0FvRixFQUNBLE1BQ0EsZUFHRixTQUFTQSxFQUFzQi9CLEdBQzdCMEYsRUFBZ0J6SyxPQUNoQnlLLEVBQWdCQyxpQkFBZ0IsS0FDOUJELEVBQWdCekosY0FDaEJZLEVBQ0dpQyxjQUFja0IsRUFBS3lDLFNBQ25CNUUsTUFBTVYsSUFDTDZDLEVBQUsrRCxZQUFZLElBRWxCbEcsTUFBSyxLQUNKNkgsRUFBZ0J4SyxPQUFPLElBRXhCcUYsT0FBT0MsSUFDTkMsTUFBTSx1Q0FDTkMsUUFBUUMsTUFBTSx1QkFBd0JILEVBQUksSUFFM0NJLFNBQVEsS0FDUDhFLEVBQWdCeEosYUFBYSxHQUM3QixHQUVSLENBSUEsU0FBUzhGLEVBQWdCaEMsR0FDbkJBLEVBQUtnRSxVQUNQbkgsRUFDR29DLGNBQWNlLEVBQUt5QyxTQUNuQjVFLE1BQU1WLElBQ0w2QyxFQUFLbUUsU0FBU2hILEVBQUltRixNQUFNLElBRXpCL0IsT0FBT0MsSUFDTkMsTUFBTSx1Q0FDTkMsUUFBUUMsTUFBTSx1QkFBd0JILEVBQUksSUFHOUMzRCxFQUNHbUMsV0FBV2dCLEVBQUt5QyxTQUNoQjVFLE1BQU1WLElBQ0w2QyxFQUFLbUUsU0FBU2hILEVBQUltRixNQUFNLElBRXpCL0IsT0FBT0MsSUFDTkMsTUFBTSx1Q0FDTkMsUUFBUUMsTUFBTSx1QkFBd0JILEVBQUksR0FHbEQsQ0EvQ0FrRixFQUFnQnJLLG9CQW1EaEJ1RSxFQUFpQnRGLG1CQUNqQnVGLEVBQWtCdkYsbUJBQ2xCd0YsRUFBc0J4RixrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWw7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICAvLyBHZW5lcmF0ZSBlcnJvciBmb3IgdGFyZ2V0IGVsZW1lbnRcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcblxuICAgIC8vIEFkZCBpbnB1dCBlcnJvciB0byBpbnB1dCBlbGVtZW50IGNsYXNzIGxpc3RcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICAvLyBDaGFuZ2UgZXJyb3IgbWVzc2FnZSB0ZXh0XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIC8vIEFkZCBlcnJvciBtZXNzYWdlIHRvIGNsYXNzIGxpc3QuXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZ0KSA9PiB7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0Rm9ybSgpIHtcbiAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCJcbiAgICApO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX29wZW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIGJ1dHRvblRleHQsIGxvYWRpbmdCdXR0b25UZXh0KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX2J1dHRvbi1zdWJtaXRcIlxuICAgICk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IGJ1dHRvblRleHQ7XG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvblRleHQgPSBsb2FkaW5nQnV0dG9uVGV4dDtcbiAgfVxuXG4gIHNob3dMb2FkaW5nKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0O1xuICB9XG5cbiAgaGlkZUxvYWRpbmcoKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXG4gICAgKTtcbiAgICBjb25zdCBkYXRhID0ge307XG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBkYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XG4iLCIvLyBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJMYXRlbWFyXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuLy8gICB9LFxuLy8gXTtcblxuY29uc3Qgc2VsZWN0b3JzID0ge1xuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgY2FyZHNMaXN0OiBcIiNjYXJkcy1saXN0XCIsXG5cbiAgZWRpdEF2YXRGb3JtTW9kYWw6IFwiI3Byb2ZpbGUtYXZhdGFyLW1vZGFsXCIsXG4gIGVkaXRQcm9mRm9ybU1vZGFsOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgYWRkQ2FyZEZvcm1Nb2RhbDogXCIjYWRkLWNhcmQtbW9kYWxcIixcbiAgZGVsQ2FyZENvbmZpcm1Nb2RhbDogXCIjZGVsZXRlLWNhcmQtbW9kYWxcIixcbiAgcHJldmlld0ltYWdlTW9kYWw6IFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIixcblxuICBwcm9mQXZhdGFyOiBcIiNwcm9maWxlLWF2YXRhclwiLFxuICBwcm9mTmFtZTogXCIjcHJvZmlsZS1uYW1lXCIsXG4gIHByb2ZBYm91dDogXCIjcHJvZmlsZS1hYm91dFwiLFxuXG4gIGZvcm1Nb2RhbENvbnRhaW5lcjogXCIubW9kYWxfX2NvbnRhaW5lclwiLFxuICBpbWFnZU1vZGFsQ29udGFpbmVyOiBcIi5tb2RhbF9fcG9wdXBcIixcbiAgZm9ybUlucHV0TmFtZTogXCIjbmFtZVwiLFxuICBmb3JtSW5wdXRBYm91dDogXCIjcHJvZmVzc2lvblwiLFxufTtcblxuY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvbi1zdWJtaXRcIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9lcnJvclwiLFxufTtcblxuZXhwb3J0IHsgc2VsZWN0b3JzLCBjb25maWcgfTtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLSBJTVBPUlQgQ0xBU1NFUyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwQ29uZmlybS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgeyBzZWxlY3RvcnMsIGNvbmZpZyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIwZDM0YTkyYy0xZGE3LTRhZGMtYWJjMC1lMmIzYjM4YTRiMWZcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vLyBGaW5kIGJ1dHRvbnMuXG5jb25zdCBlZGl0QXZhdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItY29udGFpbmVyXCIpO1xuY29uc3QgZWRpdFByb2ZCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1jYXJkLWJ1dHRvblwiKTtcblxuLy8gRmluZCBlZGl0IGZvcm0gaW5wdXQgZWxlbWVudHMuXG5jb25zdCBwcm9mTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xuY29uc3QgcHJvZkFib3V0SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWJvdXQtaW5wdXRcIik7XG5cbi8vICBGaW5kIGZvcm0gZWxlbWVudHMuXG5jb25zdCBwcm9mRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtY2FyZC1mb3JtXCJdO1xuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImFkZC1jYXJkLWZvcm1cIl07XG5jb25zdCBhdmF0RWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImF2YXRhci1lZGl0LWZvcm1cIl07XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0gRm9ybSBWYWxpZGF0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGFkZENhcmRGb3JtKTtcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBwcm9mRWRpdEZvcm0pO1xuY29uc3QgYXZhdEVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBhdmF0RWRpdEZvcm0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2FyZCBIYW5kbGVyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5sZXQgY2FyZFNlY3Rpb247XG5sZXQgY2FyZDtcblxuLyogLS0tLS0tLS0tLS0tLS0tIEVkaXQgQXZhdGFyIENhcmQgLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIEVkaXQgcHJvZmlsZSBBdmF0YXIgdGh1bWJuYWlsIGltYWdlRGF0YSB7YXZhdFVSTH1cbmNvbnN0IGVkaXRBdmF0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgc2VsZWN0b3JzLmVkaXRBdmF0Rm9ybU1vZGFsLFxuICBoYW5kbGVBdmF0YXJTdWJtaXQsXG4gIFwiU2F2ZVwiLFxuICBcIlNhdmluZy4uLlwiXG4pO1xuZWRpdEF2YXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGltYWdlRGF0YSkge1xuICBlZGl0QXZhdFBvcHVwLnNob3dMb2FkaW5nKCk7XG4gIGFwaVxuICAgIC5zZXRBdmF0YXJBUEkoaW1hZ2VEYXRhLmF2YXRVUkwpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKGltYWdlRGF0YS5hdmF0VVJMKTtcbiAgICB9KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGVkaXRBdmF0UG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBhbGVydChcIlVuZXhwZWN0ZWQgZXJyb3IsIHBsZWFzZSB0cnkgYWdhaW4uXCIpO1xuICAgICAgY29uc29sZS5lcnJvcihcIlRoZXJlIHdhcyBhbiBlcnJvciAtXCIsIGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0QXZhdFBvcHVwLmhpZGVMb2FkaW5nKCk7XG4gICAgfSk7XG59XG5cbmVkaXRBdmF0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIC8vIE9wZW4gdGhlIGF2YXRhciBlZGl0IG1vZGFsIGZvcm1cbiAgZWRpdEF2YXRQb3B1cC5vcGVuKCk7XG4gIC8vIFJlc2V0IHZhbGlkYXRpb24gZm9yIHRoZSBhdmF0YXIgZWRpdCBtb2RhbCBmb3JtXG4gIGF2YXRFZGl0Rm9ybVZhbGlkYXRvci5yZXNldEZvcm0oKTtcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tIFByb2ZpbGUgSW5mbyAtLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgcHJvZkF2YXRhclNlbGVjdG9yOiBzZWxlY3RvcnMucHJvZkF2YXRhcixcbiAgcHJvZk5hbWVTZWxlY3Rvcjogc2VsZWN0b3JzLnByb2ZOYW1lLFxuICBwcm9mQWJvdXRTZWxlY3Rvcjogc2VsZWN0b3JzLnByb2ZBYm91dCxcbn0pO1xuXG5jb25zdCBlZGl0UHJvZkluZm8gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgc2VsZWN0b3JzLmVkaXRQcm9mRm9ybU1vZGFsLFxuICBoYW5kbGVQcm9mRWRpdFN1Ym1pdCxcbiAgXCJTYXZlXCIsXG4gIFwiU2F2aW5nLi4uXCJcbik7XG5lZGl0UHJvZkluZm8uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmZ1bmN0aW9uIGhhbmRsZVByb2ZFZGl0U3VibWl0KHsgbmFtZSwgYWJvdXQgfSkge1xuICBlZGl0UHJvZkluZm8uc2hvd0xvYWRpbmcoKTtcbiAgYXBpXG4gICAgLnNldFByb2ZpbGVJbmZvQVBJKG5hbWUsIGFib3V0KVxuICAgIC50aGVuKChkYXRhQVBJKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRQcm9maWxlSW5mbyh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGFib3V0OiBhYm91dCxcbiAgICAgIH0pO1xuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgZWRpdFByb2ZJbmZvLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgYWxlcnQoXCJVbmV4cGVjdGVkIGVycm9yLCBwbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUaGVyZSB3YXMgYW4gZXJyb3IgLVwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdFByb2ZJbmZvLmhpZGVMb2FkaW5nKCk7XG4gICAgfSk7XG59XG5cbmVkaXRQcm9mQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIC8vIE9wZW4gdGhlIGF2YXRhciBlZGl0IG1vZGFsIGZvcm1cbiAgZWRpdFByb2ZJbmZvLm9wZW4oKTtcblxuICAvLyBBZGQgdGhlIHByb2ZpbGUgaW5mbyBmcm9tIHRoZSBwYWdlIHRvIHRoZSBmb3JtJ3MgZmllbGRzXG4gIGNvbnN0IHByb2ZJbmZvID0gdXNlckluZm8uZ2V0UHJvZmlsZUluZm8oKTtcbiAgcHJvZk5hbWVJbnB1dC52YWx1ZSA9IHByb2ZJbmZvLm5hbWU7XG4gIHByb2ZBYm91dElucHV0LnZhbHVlID0gcHJvZkluZm8uYWJvdXQ7XG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLUNyZWF0ZSBJbml0aWFsIENhcmRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyBSZWNlaXZlcyBjYXJkIGRhdGEoY2FyZERhdGEpIGZyb20gQVBJIGFuZCByZW5kZXJzIGRhdGEgdG8gY2FyZHMuXG5hcGlcbiAgLmdldEluZm9BUEkoKVxuICAudGhlbigoW2NhcmREYXRhLCB1c2VyRGF0YV0pID0+IHtcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZERhdGEsXG4gICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcbiAgICAgICAgICAvLyBSZW5kZXJzIGEgbmV3IGNhcmRcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEsIHVzZXJEYXRhLl9pZCk7XG5cbiAgICAgICAgICAvLyBBZGRzIGVhY2ggcmVuZGVyZWQgY2FyZCB0byB0aGUgRE9NLlxuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHNlbGVjdG9ycy5jYXJkc0xpc3RcbiAgICApO1xuXG4gICAgLy8gUmVuZGVycyBlYWNoIGNhcmQgdmlhIFNlY3Rpb24uanMgdG8gdGhlIERPTS5cbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICAgIHVzZXJJbmZvLnNldFByb2ZpbGVJbmZvKHVzZXJEYXRhKTtcbiAgICB1c2VySW5mby5zZXRBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBhbGVydChcIlVuZXhwZWN0ZWQgZXJyb3IsIHBsZWFzZSB0cnkgYWdhaW4uXCIpO1xuICAgIGNvbnNvbGUuZXJyb3IoXCJUaGVyZSB3YXMgYW4gZXJyb3IgLVwiLCBlcnIpO1xuICB9KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLUNyZWF0ZSBDYXJkIEhhbmRsZXIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyBhIG5ldyBjYXJkXG4vLyBjYXJkRGF0YSA9IEFQSSBkYXRhIHsgbmFtZSwgbGluaywgbGlrZXMsIG93bmVyLCBfaWQgfSBmcm9tIGNhcmQuXG4vLyB1c2VySUQgPSBBUEkgZGF0YSBJRCBmcm9tIHByb2ZpbGUgdXNlci5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEsIHVzZXJJRCkge1xuICBjb25zdCBjYXJkU2VsZWN0b3IgPSBzZWxlY3RvcnMuY2FyZFRlbXBsYXRlO1xuXG4gIGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDYXJkUG9wdXAsXG4gICAgaGFuZGxlTGlrZUNsaWNrLFxuICAgIHVzZXJJRFxuICApO1xuXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn1cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0gUHJldmlldyBQb3B1cCAtLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIENyZWF0ZSBpbWFnZSBQb3B1cCBpbnN0YW5jZS5cbmNvbnN0IGNhcmRQcmV2UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLnByZXZpZXdJbWFnZU1vZGFsKTtcblxuLy8gaW1hZ2VEYXRhID0ge2xpbms6LCBuYW1lOn1cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soaW1hZ2VEYXRhKSB7XG4gIGNhcmRQcmV2UG9wdXAub3BlbihpbWFnZURhdGEpO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tIEFkZCBDYXJkIC0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuY29uc3QgYWRkQ2FyZEZvcm1Nb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBzZWxlY3RvcnMuYWRkQ2FyZEZvcm1Nb2RhbCxcbiAgaGFuZGxlQWRkQ2FyZFN1Ym1pdCxcbiAgXCJDcmVhdGVcIixcbiAgXCJDcmVhdGluZy4uLlwiXG4pO1xuYWRkQ2FyZEZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdCh7IG5hbWUsIGxpbmsgfSkge1xuICBhZGRDYXJkRm9ybU1vZGFsLnNob3dMb2FkaW5nKCk7XG4gIGFwaVxuICAgIC5hZGRDYXJkQVBJKHsgbmFtZSwgbGluayB9KVxuICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYSBuZXcgY2FyZFxuICAgICAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoY2FyZCwgY2FyZC5vd25lci5faWQsIGNhcmQuX2lkKTtcbiAgICAgIC8vIEFkZCB0aGUgbmV3IGNhcmQgdG8gdGhlIHNlY3Rpb25cbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZCk7XG4gICAgfSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBhZGRDYXJkRm9ybU1vZGFsLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgYWxlcnQoXCJVbmV4cGVjdGVkIGVycm9yLCBwbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUaGVyZSB3YXMgYW4gZXJyb3IgLVwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkQ2FyZEZvcm1Nb2RhbC5oaWRlTG9hZGluZygpO1xuICAgIH0pO1xufVxuLy8gT3BlbiB0aGUgbW9kYWwgd2hlbiB1c2VycyBjbGljayBvbiB0aGUgYWRkIGJ1dHRvblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAvLyBPcGVuIHRoZSBhZGQgY2FyZCBmb3JtXG4gIGFkZENhcmRGb3JtTW9kYWwub3BlbigpO1xuICAvLyBSZXNldCB2YWxpZGF0aW9uIGZvciB0aGUgYWRkIGNhcmQgZm9ybVxuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0Rm9ybSgpO1xufSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tIERlbGV0ZSBDYXJkIC0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IG5ldyBQb3B1cENvbmZpcm0oXG4gIHNlbGVjdG9ycy5kZWxDYXJkQ29uZmlybU1vZGFsLFxuICBoYW5kbGVEZWxldGVDYXJkUG9wdXAsXG4gIFwiWWVzXCIsXG4gIFwiRGVsZXRpbmcuLi5cIlxuKTtcbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZFBvcHVwKGNhcmQpIHtcbiAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcbiAgZGVsZXRlQ2FyZE1vZGFsLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgZGVsZXRlQ2FyZE1vZGFsLnNob3dMb2FkaW5nKCk7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZEFQSShjYXJkLl9jYXJkSWQpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgYWxlcnQoXCJVbmV4cGVjdGVkIGVycm9yLCBwbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlRoZXJlIHdhcyBhbiBlcnJvciAtXCIsIGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBkZWxldGVDYXJkTW9kYWwuaGlkZUxvYWRpbmcoKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLSBMaWtlcyAtLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XG4gIGlmIChjYXJkLmlzTGlrZWQoKSkge1xuICAgIGFwaVxuICAgICAgLnJlbW92ZUxpa2VBUEkoY2FyZC5fY2FyZElkKVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgYWxlcnQoXCJVbmV4cGVjdGVkIGVycm9yLCBwbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlRoZXJlIHdhcyBhbiBlcnJvciAtXCIsIGVycik7XG4gICAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBhcGlcbiAgICAgIC5hZGRMaWtlQVBJKGNhcmQuX2NhcmRJZClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGFsZXJ0KFwiVW5leHBlY3RlZCBlcnJvciwgcGxlYXNlIHRyeSBhZ2Fpbi5cIik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJUaGVyZSB3YXMgYW4gZXJyb3IgLVwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH1cbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLSBFbmFibGUgVmFsaWRhdGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYXZhdEVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cbiAgLy8gQVBJIGNhbGxiYWNrLlxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBnZXRJbmZvQVBJKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHNBUEkoKSwgdGhpcy5nZXRQcm9maWxlSW5mb0FQSSgpXSk7XG4gIH1cblxuICAvLyBQb3B1bGF0ZSBwYWdlIGluaXRpYWxseSB3aXRoIGNhcmRzLlxuICBnZXRJbml0aWFsQ2FyZHNBUEkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gR2V0IHByb2ZpbGUgaW5mby5cblxuICBnZXRQcm9maWxlSW5mb0FQSSgpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBzZXRQcm9maWxlSW5mb0FQSShuYW1lLCBhYm91dCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuICAvLyBBbGxvd3MgdXNlciB0byBjaGFuZ2UgcHJvZmlsZSBwaWN0dXJlLlxuICBzZXRBdmF0YXJBUEkoaW1nTGluaykge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBpbWdMaW5rLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBhZGRDYXJkQVBJKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZEFQSShjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgYWRkTGlrZUFQSShjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlTGlrZUFQSShjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBwcm9mTmFtZVNlbGVjdG9yLCBwcm9mQWJvdXRTZWxlY3RvciwgcHJvZkF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wcm9mQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9mQXZhdGFyU2VsZWN0b3IpO1xuICAgIHRoaXMuX3Byb2ZOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9mTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9mQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZBYm91dFNlbGVjdG9yKTtcbiAgfVxuXG4gIC8vIEdldCBwcm9maWxlIGluZm8gZnJvbSBwYWdlLlxuICBnZXRQcm9maWxlSW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fcHJvZk5hbWUudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fcHJvZkFib3V0LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICAvLyBBZGQgcHJvZmlsZSBpbmZvIHRvIHBhZ2UuXG4gIHNldFByb2ZpbGVJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHRoaXMuX3Byb2ZOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9wcm9mQWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIGdldEF2YXRhcigpIHtcbiAgICByZXR1cm4gdGhpcy5fcHJvZkF2YXRhci5zcmM7XG4gIH1cblxuICBzZXRBdmF0YXIoaW1nTGluaykge1xuICAgIHRoaXMuX3Byb2ZBdmF0YXIuc3JjID0gaW1nTGluaztcbiAgfVxuXG4gIG9wZW5Nb2RhbCgpIHt9XG59XG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IG5hbWUsIGxpbmssIGxpa2VzLCBvd25lciwgX2lkIH0sXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2FyZFBvcHVwLFxuICAgIGhhbmRsZUxpa2VDbGljayxcbiAgICB1c2VySUQsXG4gICAgY2FyZEVsZW1lbnQsXG4gICAgY2FyZERlbGV0ZUJ1dHRvbixcbiAgICBjYXJkSW1hZ2UsXG4gICAgY2FyZFRpdGxlLFxuICAgIGxpa2VDb3VudGVyXG4gICkge1xuICAgIHRoaXMuX2NhcmRJZCA9IF9pZDtcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uID0gY2FyZERlbGV0ZUJ1dHRvbjtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGNhcmRFbGVtZW50O1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IGNhcmRJbWFnZTtcbiAgICB0aGlzLl9jYXJkT3duZXJJRCA9IG93bmVyLl9pZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gY2FyZFRpdGxlO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2ltYWdlTGluayA9IGxpbms7XG4gICAgdGhpcy5faW1hZ2VOYW1lID0gbmFtZTtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkUG9wdXAgPSBoYW5kbGVEZWxldGVDYXJkUG9wdXA7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gbGlrZUNvdW50ZXI7XG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcbiAgICB0aGlzLl91c2VySUQgPSB1c2VySUQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKVxuICAgICk7XG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmRQb3B1cCh0aGlzKVxuICAgICk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbGluazogdGhpcy5faW1hZ2VMaW5rLCBuYW1lOiB0aGlzLl9pbWFnZU5hbWUgfSlcbiAgICApO1xuICAgIHRoaXMuX2ZpbGxDYXJkVGVtcGxhdGUoKTtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZHMtdGVtcGxhdGUtbGlzdFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuXG4gIF9maWxsQ2FyZFRlbXBsYXRlKCkge1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9wcm9mTmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5faW1hZ2VMaW5rO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LmlkID0gdGhpcy5fdXNlcklEO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX2ltYWdlTmFtZTtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICAgIGlmICh0aGlzLl91c2VySUQgIT09IHRoaXMuX2NhcmRPd25lcklEKSB7XG4gICAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIGRlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJRCk7XG4gIH1cbiAgc2V0TGlrZXMobnVtT2ZMaWtlcykge1xuICAgIHRoaXMuX2xpa2VzID0gbnVtT2ZMaWtlcztcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIHRoaXMuX2xpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fbGlrZUNvdW50ZXIgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtbGlrZS1jb3VudGVyXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNjYXJkLWRlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhcmQ7XG4iLCJjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIC8vIFJlbmRlcnMgYWxsIGVsZW1lbnRzIG9uIHRoZSBwYWdlXG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcy5yZXZlcnNlKCkuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICAvLyBBZGRzIHRoZSBET00gZWxlbWVudCB0byB0aGUgY29udGFpbmVyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiI21vZGFsLXByZXZpZXctaW1hZ2VcIlxuICAgICk7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNtb2RhbC1wcmV2aWV3LXRpdGxlXCJcbiAgICApO1xuXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIG9wZW4oaW1hZ2VEYXRhKSB7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGltYWdlRGF0YS5saW5rO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBgSW1hZ2UgJHtpbWFnZURhdGEubmFtZX1gO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGltYWdlRGF0YS5uYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcbiIsImltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuL1BvcHVwV2l0aEZvcm0uanNcIjtcblxuY2xhc3MgUG9wdXBDb25maXJtIGV4dGVuZHMgUG9wdXBXaXRoRm9ybSB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGJ1dHRvblRleHQsIGhhbmRsZUZvcm1TdWJtaXQsIGxvYWRpbmdCdXR0b25UZXh0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3RvciwgYnV0dG9uVGV4dCwgaGFuZGxlRm9ybVN1Ym1pdCwgbG9hZGluZ0J1dHRvblRleHQpO1xuICAgIHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0ID0gbG9hZGluZ0J1dHRvblRleHQ7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwQ29uZmlybTtcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJmb3JtRWwiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX3RvZ2dsZUlucHV0RXJyb3IiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImV2ZXJ5IiwiX2Rpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsIl9lbmFibGVCdXR0b24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0Rm9ybSIsImlucHV0RWxlbWVudCIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cCIsImhhbmRsZUZvcm1TdWJtaXQiLCJidXR0b25UZXh0IiwibG9hZGluZ0J1dHRvblRleHQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9zdWJtaXRCdXR0b25UZXh0IiwiX2xvYWRpbmdCdXR0b25UZXh0Iiwic2hvd0xvYWRpbmciLCJoaWRlTG9hZGluZyIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0TGlzdCIsImRhdGEiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsImV2ZW50IiwicmVzZXQiLCJzZWxlY3RvcnMiLCJmb3JtU2VsZWN0b3IiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJfcmVxdWVzdCIsInVybCIsIm9wdGlvbnMiLCJmZXRjaCIsInRoZW4iLCJnZXRJbmZvQVBJIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzQVBJIiwiZ2V0UHJvZmlsZUluZm9BUEkiLCJzZXRQcm9maWxlSW5mb0FQSSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRBdmF0YXJBUEkiLCJpbWdMaW5rIiwiYXZhdGFyIiwiYWRkQ2FyZEFQSSIsIl9yZWYyIiwibGluayIsImRlbGV0ZUNhcmRBUEkiLCJjYXJkSWQiLCJhZGRMaWtlQVBJIiwicmVtb3ZlTGlrZUFQSSIsImF1dGhvcml6YXRpb24iLCJlZGl0QXZhdEJ1dHRvbiIsImVkaXRQcm9mQnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsInByb2ZOYW1lSW5wdXQiLCJwcm9mQWJvdXRJbnB1dCIsInByb2ZFZGl0Rm9ybSIsImZvcm1zIiwiYWRkQ2FyZEZvcm0iLCJhdmF0RWRpdEZvcm0iLCJhZGRGb3JtVmFsaWRhdG9yIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhdmF0RWRpdEZvcm1WYWxpZGF0b3IiLCJjYXJkU2VjdGlvbiIsImNhcmQiLCJlZGl0QXZhdFBvcHVwIiwiUG9wdXBXaXRoRm9ybSIsImltYWdlRGF0YSIsImF2YXRVUkwiLCJ1c2VySW5mbyIsInNldEF2YXRhciIsImNhdGNoIiwiZXJyIiwiYWxlcnQiLCJjb25zb2xlIiwiZXJyb3IiLCJmaW5hbGx5IiwicHJvZk5hbWVTZWxlY3RvciIsInByb2ZBYm91dFNlbGVjdG9yIiwicHJvZkF2YXRhclNlbGVjdG9yIiwiX3Byb2ZBdmF0YXIiLCJfcHJvZk5hbWUiLCJfcHJvZkFib3V0IiwiZ2V0UHJvZmlsZUluZm8iLCJzZXRQcm9maWxlSW5mbyIsImdldEF2YXRhciIsInNyYyIsIm9wZW5Nb2RhbCIsImVkaXRQcm9mSW5mbyIsImRhdGFBUEkiLCJjcmVhdGVDYXJkIiwiY2FyZERhdGEiLCJ1c2VySUQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZFBvcHVwIiwiaGFuZGxlTGlrZUNsaWNrIiwiY2FyZEVsZW1lbnQiLCJjYXJkRGVsZXRlQnV0dG9uIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwibGlrZUNvdW50ZXIiLCJsaWtlcyIsIm93bmVyIiwiX2lkIiwiX2NhcmRJZCIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwiX2NhcmRJbWFnZSIsIl9jYXJkT3duZXJJRCIsIl9jYXJkU2VsZWN0b3IiLCJfY2FyZFRpdGxlIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaW1hZ2VMaW5rIiwiX2ltYWdlTmFtZSIsIl9oYW5kbGVEZWxldGVDYXJkUG9wdXAiLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2xpa2VDb3VudGVyIiwiX2xpa2VzIiwiX3VzZXJJRCIsIl9saWtlQnV0dG9uIiwiX2ZpbGxDYXJkVGVtcGxhdGUiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiYWx0IiwiX3JlbmRlckxpa2VzIiwiZGVsZXRlQ2FyZCIsImlzTGlrZWQiLCJzb21lIiwibGlrZSIsInNldExpa2VzIiwibnVtT2ZMaWtlcyIsImxlbmd0aCIsImdldFZpZXciLCJwcm9mSW5mbyIsInVzZXJEYXRhIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJyZXZlcnNlIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZFByZXZQb3B1cCIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VDYXB0aW9uIiwiYWRkQ2FyZEZvcm1Nb2RhbCIsIl9yZWYzIiwibmV3Q2FyZCIsImRlbGV0ZUNhcmRNb2RhbCIsInNldFN1Ym1pdEFjdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=